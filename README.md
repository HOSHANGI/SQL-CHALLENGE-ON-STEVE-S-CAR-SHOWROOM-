# SQL-CHALLENGE-ON-STEVE-S-CAR-SHOWROOM-

QUESTIONS:--
1. What are the details of all cars purchased in the year 2022?
2. What is the total number of cars sold by each salesperson?
3. What is the total revenue generated by each salesperson?
4. What are the details of the cars sold by each salesperson?
5. What is the total revenue generated by each car type?
6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?
7. What is the total revenue generated by the sales of hatchback cars?
8. What is the total revenue generated by the sales of SUV cars in the year 2022?
9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?
10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?

--1. What are the details of all cars purchased in the year 2022?

SELECT sales.car_id, COUNT(sales.car_id) AS total_number_of_cars,
       make, type, style, cost_$, SUM(cost_$) AS total_$
FROM sales
JOIN cars ON cars.car_id = sales.car_id
WHERE EXTRACT(YEAR FROM purchase_date) = 2022
GROUP BY sales.car_id, make, type, style, cost_$;


--2, What is the total number of cars sold by each salesperson?

SELECT salesman_id, COUNT(car_id) as total_cars_sold
FROM sales
GROUP BY salesman_id;
                        OR
SELECT SP.SALESMAN_ID, NAME, COUNT(CAR_ID) NUMBER_OF_CARS_SOLD
FROM SALES 
JOIN SALESPERSONS SP
ON SP.SALESMAN_ID = SALES.SALESMAN_ID
GROUP BY SP.SALESMAN_ID
ORDER BY SP.SALESMAN_ID;


--3, What is the total revenue generated by each salesperson?

SELECT SALES.SALESMAN_ID, SALESPERSONS.NAME, SUM(CARS.COST_$) AS REVENUE
FROM SALES
JOIN CARS ON SALES.CAR_ID = CARS.CAR_ID
JOIN SALESPERSONS ON SALESPERSONS.SALESMAN_ID = SALES.SALESMAN_ID
GROUP BY SALES.SALESMAN_ID, SALESPERSONS.NAME
ORDER BY SALES.SALESMAN_ID;


--4, What are the details of the cars sold by each salesperson?

SELECT SALES.SALESMAN_ID, SALESPERSONS.NAME, SALES.CAR_ID, COUNT(SALES.CAR_ID) AS NUMBER_OF_CARS,
       CARS.MAKE, CARS.TYPE, CARS.STYLE, SUM(CARS.COST_$) AS PRICE
FROM SALES
JOIN CARS ON SALES.CAR_ID = CARS.CAR_ID
JOIN SALESPERSONS ON SALESPERSONS.SALESMAN_ID = SALES.SALESMAN_ID
GROUP BY SALES.SALESMAN_ID, SALESPERSONS.NAME, SALES.CAR_ID, CARS.MAKE, CARS.TYPE, CARS.STYLE;


--5, What is the total revenue generated by each car type?

SELECT S.CAR_ID, C.TYPE, SUM(C.COST_$) AS REVENUE
FROM SALES S
JOIN CARS C ON S.CAR_ID = C.CAR_ID
GROUP BY S.CAR_ID, C.TYPE
ORDER BY S.CAR_ID;


--6, What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

SELECT SALES.SALESMAN_ID, NAME, SALES.CAR_ID, MAKE, TYPE, STYLE, COST_$
FROM SALES 
JOIN CARS ON SALES.CAR_ID = CARS.CAR_ID
JOIN SALESPERSONS ON SALESPERSONS.SALESMAN_ID = SALES.SALESMAN_ID
WHERE salespersons.name = 'Emily Wong' AND EXTRACT(YEAR FROM sales.purchase_date) = 2021;


--7, What is the total revenue generated by the sales of hatchback cars?

SELECT cars.style, SUM(cars.cost_$) AS revenue
FROM sales s
JOIN cars ON cars.car_id = s.car_id
WHERE cars.style = 'Hatchback'
GROUP BY cars.style;


--8, What is the total revenue generated by the sales of SUV cars in the year 2022?

SELECT CARS.STYLE, SUM(CARS.COST_$) AS REVENUE
FROM SALES S 
JOIN CARS ON CARS.CAR_ID = S.CAR_ID
WHERE CARS.STYLE = 'SUV' AND EXTRACT(YEAR FROM S.PURCHASE_DATE) = 2022
GROUP BY CARS.STYLE;


--9, What is the name and city of the salesperson who sold the most number of cars in the year 2023?

SELECT sales.salesman_id, salespersons.name, salespersons.city, COUNT(sales.car_id) AS number_of_cars
FROM sales
JOIN salespersons ON salespersons.salesman_id = sales.salesman_id
WHERE EXTRACT(YEAR FROM sales.purchase_date) = 2023
GROUP BY sales.salesman_id, salespersons.name, salespersons.city
ORDER BY COUNT(sales.car_id) DESC
LIMIT 1;


--10, What is the name and age of the salesperson who generated the highest revenue in the year 2022?

SELECT sales.salesman_id, salespersons.name, salespersons.age, SUM(cars.cost_$) AS revenue
FROM sales
JOIN salespersons ON salespersons.salesman_id = sales.salesman_id
JOIN cars ON cars.car_id = sales.car_id
WHERE EXTRACT(YEAR FROM sales.purchase_date) = 2022
GROUP BY sales.salesman_id, salespersons.name, salespersons.age
ORDER BY SUM(cars.cost_$) DESC
LIMIT 1;


![McQueen15](https://github.com/HOSHANGI/SQL-CHALLENGE-ON-STEVE-S-CAR-SHOWROOM-/assets/118753140/00a0a0df-16a5-4aeb-a303-65d63d5075d0)
![maxresdefault](https://github.com/HOSHANGI/SQL-CHALLENGE-ON-STEVE-S-CAR-SHOWROOM-/assets/118753140/2c8d0655-5f51-4d4c-b275-44e3570c5553)
![R](https://github.com/HOSHANGI/SQL-CHALLENGE-ON-STEVE-S-CAR-SHOWROOM-/assets/118753140/c64cbce6-7225-4db6-a9fb-174a33318069)
![R](https://github.com/HOSHANGI/SQL-CHALLENGE-ON-STEVE-S-CAR-SHOWROOM-/assets/118753140/c2f165ff-d9a0-4fb8-81c5-3393b2d34b9f)
